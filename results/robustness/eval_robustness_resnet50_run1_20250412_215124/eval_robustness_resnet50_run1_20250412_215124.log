2025-04-12 21:51:24,678 : --- Evaluation Arguments ---
{'batch_size': 128,
 'ckpt_erm': 'checkpoints/camelyon17/10_04_10:31_erm_resnet50_lr_0.0005_cosine_False_bsz_256_head_mlp_wd_2_200_128_trial_erm_1_temp_0.1_camelyon17_pm_0.95/checkpoint_max.pth.tar',
 'ckpt_hypo_clean': 'checkpoints/camelyon17/09_04_15:39_hypo_resnet50_lr_0.0005_cosine_False_bsz_256_head_mlp_wd_2.0_200_128_trial_0_temp_0.1_camelyon17_pm_0.95/checkpoint_max.pth.tar',
 'ckpt_hypo_corrupted': 'checkpoints/camelyon17_corrupted/20250412_170807_hypo_corrupted_resnet50_lr_0.0005_cosine_False_bsz_32_head_mlp_wd_2.0_50_128_trial_0_corrupted_temp_0.1_camelyon17_pm_0.95/checkpoint_max.pth.tar',
 'feat_dim': 128,
 'gpu': 0,
 'head': 'mlp',
 'model': 'resnet50',
 'normalize': True,
 'prefetch': 4,
 'results_dir': '../results/robustness',
 'results_suffix': '_run1',
 'seed': 42,
 'temp': 0.1,
 'wilds_root_dir': '../../data'}
2025-04-12 21:51:24,678 : Log directory: ../results/robustness/eval_robustness_resnet50_run1_20250412_215124
2025-04-12 21:51:24,681 : Loading clean Camelyon17 data...
2025-04-12 21:51:24,993 : Clean test loader created with 85054 samples.
2025-04-12 21:51:25,281 : Loading erm model from: checkpoints/camelyon17/10_04_10:31_erm_resnet50_lr_0.0005_cosine_False_bsz_256_head_mlp_wd_2_200_128_trial_erm_1_temp_0.1_camelyon17_pm_0.95/checkpoint_max.pth.tar
2025-04-12 21:51:25,634 : Loading hypo_clean model from: checkpoints/camelyon17/09_04_15:39_hypo_resnet50_lr_0.0005_cosine_False_bsz_256_head_mlp_wd_2.0_200_128_trial_0_temp_0.1_camelyon17_pm_0.95/checkpoint_max.pth.tar
2025-04-12 21:51:35,587 : Loaded DisLoss criterion state (prototypes).
2025-04-12 21:51:35,588 : Loading hypo_corrupted model from: checkpoints/camelyon17_corrupted/20250412_170807_hypo_corrupted_resnet50_lr_0.0005_cosine_False_bsz_32_head_mlp_wd_2.0_50_128_trial_0_corrupted_temp_0.1_camelyon17_pm_0.95/checkpoint_max.pth.tar
2025-04-12 21:51:44,985 : Loaded DisLoss criterion state (prototypes).
2025-04-12 21:51:44,986 : --- Evaluating on Clean Test Data ---
2025-04-12 21:51:44,986 : Evaluating ERM...
